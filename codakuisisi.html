<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>OMNI AKUISISI</title>


  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />

  <!-- font awesome style -->
  <link href="css/font-awesome.min.css" rel="stylesheet" />

  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />

  <style>
    .form_container input[type="text"], .form_container input[type="email"] {
      width: 100%; /* Mengatur lebar input menjadi 100% dari container */
      box-sizing: border-box; /* Memastikan padding dan border termasuk dalam lebar total */
      margin-bottom: 10px; /* Menambahkan sedikit ruang di bawah setiap input */
    }
  
    .form_container form {
      margin: 0 auto; /* Memastikan form terpusat */
    }
  
    .form_container {
      padding: 15px; /* Menambahkan padding pada container untuk estetika */
    }
  
    button {
      width: 100%; /* Mengatur lebar button menjadi 100% */
      padding: 10px; /* Menambahkan padding pada button untuk kenyamanan */
    }
  </style>
  

</head>

<body class="sub_page">

  <div class="hero_area">
    <!-- header section strats -->
    <header class="header_section">
      <div class="container-fluid">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
          <a class="navbar-brand" href="index.html">
            <span>
              OMNI DHN
            </span>
          </a>

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class=""> </span>
          </button>

          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav  ">
              <li class="nav-item ">
                <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
              </li>
              
              <li class="nav-item active">
                <a class="nav-link" href="codakuisisi.html">Form COD AK</a>
              </li>

              <li class="nav-item">
                <a class="nav-link" href="tfakuisisi.html">Form TF AK</a>
              </li>
            </ul>
            <div class="quote_btn-container">
              <a href="" class="quote_btn">
                Logout
              </a>
            </div>
          </div>
        </nav>
      </div>
    </header>
    <!-- end header section -->
  </div>

  <!-- contact section -->

  <section class="contact_section layout_padding">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-10 col-lg-8 offset-md-1 offset-lg-2">
          <div class="form_container">
            <div class="heading_container">
              <h2>FORM ORDER COD AKUISISI</h2>
            </div>
            <form method="POST" action="https://script.google.com/macros/s/AKfycbw2a-0BZQkoSePJU8Ms_fsLDKXAJ8vo-0ZvvUXyxc71tj5Ekujb9LaQbaOH3ybBWUv5/exec">
              <div class="row">

                <div class="col-md-6 mb-3">
                  <label for="nama_customer" class="form-label">Nama Customer</label>
                  <input type="text" class="form-control" id="nama_customer" name="nama_customer" placeholder="Nama Customer" oninput="this.value = this.value.toUpperCase();">
                </div>

                <div class="col-md-6 mb-3">
                  <label for="no_hp_customer" class="form-label">No HP Customer</label>
                  <input type="text" class="form-control" id="no_hp_customer" name="no_hp_customer" placeholder="62" oninput="formatPhoneNumber(this)">
                </div>
                
                
                <div class="col-md-12 mb-3">
                  <label for="alamat" class="form-label">Alamat Customer</label>
                  <input type="textarea" class="form-control" id="alamat" name="alamat" placeholder="Alamat Customer" oninput="this.value = this.value.toUpperCase();">
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="kecamatan" class="form-label">Kecamatan</label>
                  <input type="text" class="form-control" id="kecamatan" name="kecamatan" placeholder="Kecamatan" oninput="this.value = this.value.toUpperCase();">
                </div>               

                <div class="col-md-6 mb-3 mb-3">
                  <label for="kabupaten_kota" class="form-label">Kabupaten / Kota</label>
                  <select class="form-control form-label" id="kabupaten_kota" name="kabupaten_kota" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <!-- Add more options as needed -->
                  </select>
                </div>

                <div class="col-md-12 mb-3">
                  <hr style="border: 1px solid #ccc; margin: 20px 0;">
                </div>
                

                <div class="col-md-4 mb-3 mb-3">
                  <label for="product" class="form-label">Product</label>
                  <select class="form-control form-label" id="product" name="product" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <!-- Add more options as needed -->
                  </select>
                </div>

                <div class="col-md-4 mb-3">
                  <label for="qty" class="form-label">Quantity</label>
                  <input type="number" class="form-control" id="qty" name="qty" placeholder="qty" oninput="this.value = this.value.toUpperCase();">
                </div>  

                <div class="col-md-4 mb-3 mb-3">
                  <label for="gift" class="form-label">Gift</label>
                  <select class="form-control form-label" id="gift" name="gift" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <!-- Add more options as needed -->
                  </select>
                </div>

                <div class="col-md-6 mb-3">
                  <label for="harga_product" class="form-label">Harga Product</label>
                  <input type="text" class="form-control" id="harga_product" name="harga_product" placeholder="Rp 0" oninput="formatRupiah(this); updateTotal()">
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="biaya_ongkir" class="form-label">Biaya Ongkir</label>
                  <input type="text" class="form-control" id="biaya_ongkir" name="biaya_ongkir" placeholder="Rp 0" oninput="formatRupiah(this); updateTotal()">
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="biaya_penanganan" class="form-label">Biaya Penanganan</label>
                  <input type="text" class="form-control" id="biaya_penanganan" name="biaya_penanganan" placeholder="Rp 0" oninput="formatRupiah(this); updateTotal()">
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="diskon_ongkir" class="form-label">Discount Ongkir</label>
                  <input type="text" class="form-control" id="diskon_ongkir" name="diskon_ongkir" placeholder="Rp 0" oninput="formatRupiah(this); updateTotal()">
                </div>
                
                <div class="col-md-12 mb-3">
                  <label for="total_cod" class="form-label">Total COD</label>
                  <input type="text" class="form-control" id="total_cod" name="total_cod" placeholder="Rp 0" style="font-weight: bold;" onfocus="showWarning(this)" readonly>
                  <small class="form-text text-muted">*Note: ( [Harga Product] + [Biaya Ongkir] + [Biaya Penanganan] - [Discount Ongkir])</small>

                </div>



                <div class="col-md-12 mb-3">
                  <hr style="border: 1px solid #ccc; margin: 20px 0;">
                </div>



                <div class="col-md-6 mb-3">
                  <label for="metode_pembayaran" class="form-label">Metode Pembayaran</label>
                  <select class="form-control form-label" id="metode_pembayaran" name="metode_pembayaran" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <option value="COD">COD</option>
                    <!-- Add more options as needed -->
                  </select>
                </div>

                <div class="col-md-6 mb-3">
                  <label for="ekspedisi" class="form-label">Ekspedisi</label>
                  <select class="form-control form-label" id="ekspedisi" name="ekspedisi" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <option value="NINJA">NINJA</option>
                    <option value="JNT">JNT</option>
                    <!-- Add more options as needed -->
                  </select>
                </div>

                <div class="col-md-6 mb-3">
                  <label for="gudang" class="form-label">Gudang</label>
                  <select class="form-control form-label" id="gudang" name="gudang" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <option value="CENDANA">CENDANA</option>
                    <!-- Add more options as needed -->
                  </select>
                </div>

                <div class="col-md-6 mb-3 mb-3">
                  <label for="nama_cs" class="form-label">Nama CS</label>
                  <select class="form-control form-label" id="nama_cs" name="nama_cs" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <!-- Add more options as needed -->
                  </select>
                </div>
                
                <div class="col-md-6 mb-3 mb-3">
                  <label for="nama_adv" class="form-label">Nama ADV</label>
                  <select class="form-control form-label" id="nama_adv" name="nama_adv" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <!-- Add more options as needed -->
                  </select>
                </div>  

                <div class="col-md-6 mb-3">
                  <label for="status_customer" class="form-label">Status Customer</label>
                  <select class="form-control form-label" id="status_customer" name="status_customer" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <option value="NEW CUSTOMER">NEW CUSTOMER</option>
                    <option value="NCS">NCS</option>
                    <option value="RESELLER">RESELLER</option>
                    <!-- Add more options as needed -->
                  </select>
                </div>

                <div class="col-md-6 mb-3">
                  <label for="sumber_iklan" class="form-label">Sumber Iklan</label>
                  <select class="form-control form-label" id="sumber_iklan" name="sumber_iklan" style="height: 50px;">
                    <option value="" disabled selected hidden></option>
                    <option value="META ADS">META ADS</option>
                    <option value="TIKTOK ADS">TIKTOK ADS</option>
                    <option value="OFFICIAL/MEDSOS">OFFICIAL/MEDSOS</option>
                    <option value="MARKETPLACE">MARKETPLACE</option>
                    <option value="SNACK VIDEO">SNACK VIDEO</option>
                    <!-- Add more options as needed -->
                  </select>
                </div>
                
                <div class="col-md-6 mb-3">
                  <label for="note" class="form-label">Note Untuk Courir</label>
                  <input type="textarea" class="form-control" id="note" name="note" placeholder="Note" oninput="this.value = this.value.toUpperCase();">
                </div>
             
              </div>
              
              <div class="d-flex">
                <button type="submit">SEND</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
    

  <!-- end contact section -->

  <div class="footer_container">

  <!-- jQery -->
  <script src="js/jquery-3.4.1.min.js"></script>
  <!-- popper js -->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
  </script>
  <!-- bootstrap js -->
  <script src="js/bootstrap.js"></script>
  <script src="js/custom.js"></script>
  <!-- Google Map -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap"></script>
  <!-- End Google Map -->

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      fetch('https://script.google.com/macros/s/AKfycbw2a-0BZQkoSePJU8Ms_fsLDKXAJ8vo-0ZvvUXyxc71tj5Ekujb9LaQbaOH3ybBWUv5/exec')
        .then(response => response.json())
        .then(data => {

          // Populate the 'product' dropdown with data from column E (product)
          var productSelect = document.getElementById('product');
          data.product.forEach(function(product) {
            // Check if product is not empty or whitespace
            if (product.trim() !== '') {
              var option = document.createElement('option');
              option.value = product;
              option.textContent = product;
              productSelect.appendChild(option);
            }
          });

          // Populate the 'gift' dropdown with data from column G (gift)
          var giftSelect = document.getElementById('gift');
          data.gift.forEach(function(gift) {
            // Check if gift is not empty or whitespace
            if (gift.trim() !== '') {
              var option = document.createElement('option');
              option.value = gift;
              option.textContent = gift;
              giftSelect.appendChild(option);
            }
          });
          
          // Populate the 'nama_cs' dropdown with data from column A (nama_cs)
          var nama_csSelect = document.getElementById('nama_cs');
          data.nama_cs.forEach(function(nama_cs) {
            // Check if nama_cs is not empty or whitespace
            if (nama_cs.trim() !== '') {
              var option = document.createElement('option');
              option.value = nama_cs;
              option.textContent = nama_cs;
              nama_csSelect.appendChild(option);
            }
          });

          // Populate the 'nama_adv' dropdown with data from column C (nama_adv)
          var nama_advSelect = document.getElementById('nama_adv');
          data.nama_adv.forEach(function(nama_adv) {
            // Check if nama_adv is not empty or whitespace
            if (nama_adv.trim() !== '') {
              var option = document.createElement('option');
              option.value = nama_adv;
              option.textContent = nama_adv;
              nama_advSelect.appendChild(option);
            }
          });
    
          // Populate the 'kabupaten_kota' dropdown with data from column C (kabupaten_kota)
          var kabupatenKotaSelect = document.getElementById('kabupaten_kota');
          data.kabupaten_kota.forEach(function(kabupatenKota) {
            var option = document.createElement('option');
            option.value = kabupatenKota;
            option.textContent = kabupatenKota;
            kabupatenKotaSelect.appendChild(option);
          });

          // Populate the 'nama_adv' dropdown with data from column C (kabupaten_kota)
          var kabupatenKotaSelect = document.getElementById('kabupaten_kota');
          data.kabupaten_kota.forEach(function(kabupatenKota) {
            var option = document.createElement('option');
            option.value = kabupatenKota;
            option.textContent = kabupatenKota;
            kabupatenKotaSelect.appendChild(option);
          });
        })
        .catch(error => console.error('Error:', error));
    });
    </script>

<script>
  function formatPhoneNumber(input) {
    let value = input.value;
  
    // Cek jika pengguna sedang menghapus karakter (backspace)
    if (event.inputType === "deleteContentBackward") {
      if (value === "62") {
        // Biarkan input kosong jika pengguna menghapus sampai hanya tersisa "62"
        input.value = "";
      }
      return;
    }
  
    // Menghapus semua karakter yang bukan angka
    value = value.replace(/\D/g, '');
  
    // Jika input dimulai dengan '0', hilangkan '0' tersebut
    if (value.startsWith('0')) {
      value = value.substring(1);
    }
  
    // Tambahkan '62' di awal nomor jika belum ada
    if (!value.startsWith('62')) {
      value = '62' + value;
    }
  
    // Perbarui nilai input dengan format yang benar
    input.value = value;
  }
  </script>

<script>
  let warned = false;
  
  function formatRupiah(input) {
    let value = input.value;
  
    // Menghapus semua karakter yang bukan angka
    value = value.replace(/[^,\d]/g, '');
  
    // Menambahkan titik ribuan
    const rupiah = new Intl.NumberFormat('id-ID', {
      style: 'currency',
      currency: 'IDR',
      minimumFractionDigits: 0,
      maximumFractionDigits: 0
    }).format(value.replace(/[^,\d]/g, ''));
  
    // Memperbarui nilai input dengan format Rupiah
    input.value = rupiah.replace("Rp", "Rp ");
  }
  
  function updateTotal() {
      const harga = getNumericValue('harga_product');
      const ongkir = getNumericValue('biaya_ongkir');
      const penanganan = getNumericValue('biaya_penanganan');
      const diskon = getNumericValue('diskon_ongkir');
      const total = harga + ongkir + penanganan - diskon;
      document.getElementById('total_cod').value = formatRupiahAmount(total);
    }

    function getNumericValue(elementId) {
      return parseInt(document.getElementById(elementId).value.replace(/[^0-9]/g, '')) || 0;
    }

  
  function formatRupiahAmount(amount) {
    return new Intl.NumberFormat('id-ID', {
      style: 'currency',
      currency: 'IDR',
      minimumFractionDigits: 0,
      maximumFractionDigits: 0
    }).format(amount).replace("Rp", "Rp ");
  }
  
  function showWarning(input) {
    if (!warned) {
      if (confirm('Anda ingin mengedit Total COD? Perubahan akan mengabaikan perhitungan otomatis.')) {
        warned = true;
        input.readOnly = false; // Membiarkan pengguna mengedit
      } else {
        input.blur(); // Menghilangkan fokus dari input jika pengguna membatalkan
      }
    }
  }
  </script>
      
  
  
    
    
</body>

</html>